=======================
Emitter class reference
=======================

.. currentmodule:: data_migrator.emitters

This document covers features of the :class:`~data_migrator.emitter.BaseEmitter` class. Currently the system
has two emitter ``CSVEmitter`` and ``MySQLEmitter`` implemented, of which the last is the default emitter.
An emitter provides the export format for the scanned and cleaned datasets. It also provides preambles in
the output files, for example to clean the target table before loading it.

The basic structure for emitting is a combination between ``manager`` and ``emitter``:

.. code-block:: python

  e = Emitter(manager=Model.objects)
  print e.preamble(header=[..my header lines to add..])
  for l in Model.objects.all():
    print e.emit(l)  # emit is returning a list of strings!


.. note::

    At this moment ``data-migrator`` is not an active part in schema migrations of any sort. It is purely about
    cleaning and transforming data (yet!).


Attributes
==========

``manager``
-----------

.. attribute:: BaseEmitter.manager

    A reference to the manager that is calling this emitter to export objects from the manager


``model_class``
---------------

.. attribute:: BaseEmitter.model_class

    A reference to the model linked to the class, ``model_class`` and ``manager`` are linked together

``extension``
-------------

.. attribute:: BaseEmitter.extension

    File extension for this emitter


Methods
=======

``emit(object)``
----------------

.. method:: BaseEmitter.emit

    The ``emit`` method is were the object is translated into the target structure. For example a row is translated
    into an ``INSERT`` statement


``premable(headers)``
---------------------

.. method:: BaseEmitter.preamble

    The ``premable`` method provides the file premable for emitting the model to file


``filename()``
--------------

.. method:: BaseEmitter.filename

    The ``filename`` method generates a filename bases on :attr:`BaseEmitter.extension` and either
    :attr:`Meta.file_name` or :attr:`Meta.table_name`
